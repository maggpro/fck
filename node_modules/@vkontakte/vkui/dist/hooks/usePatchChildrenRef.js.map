{"version":3,"sources":["../../src/hooks/usePatchChildrenRef.ts"],"sourcesContent":["import * as React from 'react';\nimport { warnOnce } from '../lib/warnOnce';\nimport { useEffectDev } from './useEffectDev';\nimport { useExternRef } from './useExternRef';\n\ntype ChildrenElement<T> = React.ReactElement<{ getRootRef?: React.Ref<T> }>;\n\nconst isDOMTypeElement = (element: React.ReactElement): element is React.DOMElement<any, any> => {\n  return typeof element.type === 'string';\n};\n\nconst warn = warnOnce('usePatchChildrenRef');\n\nexport const usePatchChildrenRef = <T = HTMLElement>(\n  children?: ChildrenElement<T>,\n): [React.MutableRefObject<T | null>, ChildrenElement<T> | undefined] => {\n  const childRef =\n    React.isValidElement(children) &&\n    (isDOMTypeElement(children) ? (children.ref as React.Ref<T>) : children.props.getRootRef);\n  const patchedRef = useExternRef<T>(childRef);\n\n  useEffectDev(() => {\n    if (!patchedRef.current) {\n      warn(\n        'Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента',\n        'error',\n      );\n    }\n  }, [children?.type, patchedRef]);\n\n  return [\n    patchedRef,\n    React.isValidElement(children)\n      ? React.cloneElement(children, {\n          [isDOMTypeElement(children) ? 'ref' : 'getRootRef']: patchedRef,\n        })\n      : children,\n  ];\n};\n"],"names":["React","warnOnce","useEffectDev","useExternRef","isDOMTypeElement","element","type","warn","usePatchChildrenRef","children","childRef","isValidElement","ref","props","getRootRef","patchedRef","current","cloneElement"],"mappings":";AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,YAAY,QAAQ,iBAAiB;AAC9C,SAASC,YAAY,QAAQ,iBAAiB;AAI9C,IAAMC,mBAAmB,SAACC;IACxB,OAAO,OAAOA,QAAQC,IAAI,KAAK;AACjC;AAEA,IAAMC,OAAON,SAAS;AAEtB,OAAO,IAAMO,sBAAsB,SACjCC;IAEA,IAAMC,WACJV,MAAMW,cAAc,CAACF,aACpBL,CAAAA,iBAAiBK,YAAaA,SAASG,GAAG,GAAoBH,SAASI,KAAK,CAACC,UAAU,AAAD;IACzF,IAAMC,aAAaZ,aAAgBO;IAEnCR,aAAa;QACX,IAAI,CAACa,WAAWC,OAAO,EAAE;YACvBT,KACE,4JACA;QAEJ;IACF,GAAG;QAACE,qBAAAA,+BAAAA,SAAUH,IAAI;QAAES;KAAW;IAE/B,OAAO;QACLA;QACAf,MAAMW,cAAc,CAACF,YACjBT,MAAMiB,YAAY,CAACR,UACjB,qBAACL,iBAAiBK,YAAY,QAAQ,cAAeM,eAEvDN;KACL;AACH,EAAE"}