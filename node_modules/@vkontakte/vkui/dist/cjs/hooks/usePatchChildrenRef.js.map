{"version":3,"sources":["../../../src/hooks/usePatchChildrenRef.ts"],"sourcesContent":["import * as React from 'react';\nimport { warnOnce } from '../lib/warnOnce';\nimport { useEffectDev } from './useEffectDev';\nimport { useExternRef } from './useExternRef';\n\ntype ChildrenElement<T> = React.ReactElement<{ getRootRef?: React.Ref<T> }>;\n\nconst isDOMTypeElement = (element: React.ReactElement): element is React.DOMElement<any, any> => {\n  return typeof element.type === 'string';\n};\n\nconst warn = warnOnce('usePatchChildrenRef');\n\nexport const usePatchChildrenRef = <T = HTMLElement>(\n  children?: ChildrenElement<T>,\n): [React.MutableRefObject<T | null>, ChildrenElement<T> | undefined] => {\n  const childRef =\n    React.isValidElement(children) &&\n    (isDOMTypeElement(children) ? (children.ref as React.Ref<T>) : children.props.getRootRef);\n  const patchedRef = useExternRef<T>(childRef);\n\n  useEffectDev(() => {\n    if (!patchedRef.current) {\n      warn(\n        'Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента',\n        'error',\n      );\n    }\n  }, [children?.type, patchedRef]);\n\n  return [\n    patchedRef,\n    React.isValidElement(children)\n      ? React.cloneElement(children, {\n          [isDOMTypeElement(children) ? 'ref' : 'getRootRef']: patchedRef,\n        })\n      : children,\n  ];\n};\n"],"names":["usePatchChildrenRef","isDOMTypeElement","element","type","warn","warnOnce","children","childRef","React","isValidElement","ref","props","getRootRef","patchedRef","useExternRef","useEffectDev","current","cloneElement"],"mappings":";;;;+BAaaA;;;eAAAA;;;;;+DAbU;wBACE;4BACI;4BACA;AAI7B,IAAMC,mBAAmB,SAACC;IACxB,OAAO,OAAOA,QAAQC,IAAI,KAAK;AACjC;AAEA,IAAMC,OAAOC,IAAAA,kBAAQ,EAAC;AAEf,IAAML,sBAAsB,SACjCM;IAEA,IAAMC,WACJC,OAAMC,cAAc,CAACH,aACpBL,CAAAA,iBAAiBK,YAAaA,SAASI,GAAG,GAAoBJ,SAASK,KAAK,CAACC,UAAU,AAAD;IACzF,IAAMC,aAAaC,IAAAA,0BAAY,EAAIP;IAEnCQ,IAAAA,0BAAY,EAAC;QACX,IAAI,CAACF,WAAWG,OAAO,EAAE;YACvBZ,KACE,4JACA;QAEJ;IACF,GAAG;QAACE,qBAAAA,+BAAAA,SAAUH,IAAI;QAAEU;KAAW;IAE/B,OAAO;QACLA;QACAL,OAAMC,cAAc,CAACH,YACjBE,OAAMS,YAAY,CAACX,UACjB,uBAACL,iBAAiBK,YAAY,QAAQ,cAAeO,eAEvDP;KACL;AACH"}