{"version":3,"sources":["../../../../src/lib/adaptivity/functions.ts"],"sourcesContent":["import type { Exact } from '../../types';\nimport { Platform, type PlatformType } from '../platform';\nimport {\n  BREAKPOINTS,\n  SizeType,\n  VIEW_WIDTH_TO_CSS_BREAKPOINT_MAP,\n  ViewHeight,\n  ViewWidth,\n} from './constants';\nimport type { CSSBreakpointsClassNames, MediaQueries } from './types';\n\n/**\n * @public\n */\nexport function getViewWidthByViewportWidth(viewportWidth: number) {\n  if (viewportWidth >= BREAKPOINTS.DESKTOP) {\n    return ViewWidth.DESKTOP;\n  }\n  if (viewportWidth >= BREAKPOINTS.TABLET) {\n    return ViewWidth.TABLET;\n  }\n  if (viewportWidth >= BREAKPOINTS.SMALL_TABLET) {\n    return ViewWidth.SMALL_TABLET;\n  }\n  if (viewportWidth >= BREAKPOINTS.MOBILE) {\n    return ViewWidth.MOBILE;\n  }\n  return ViewWidth.SMALL_MOBILE;\n}\n\nexport function getViewWidthByMediaQueries(mediaQueries: MediaQueries): ViewWidth {\n  /* eslint-disable no-restricted-properties */\n  if (mediaQueries.desktopPlus.matches) {\n    return ViewWidth.DESKTOP;\n  }\n  if (mediaQueries.tablet.matches) {\n    return ViewWidth.TABLET;\n  }\n  if (mediaQueries.smallTablet.matches) {\n    return ViewWidth.SMALL_TABLET;\n  }\n  if (mediaQueries.mobile.matches) {\n    return ViewWidth.MOBILE;\n  }\n  /* eslint-enable no-restricted-properties */\n  return ViewWidth.SMALL_MOBILE;\n}\n\n/**\n * @public\n */\nexport function getViewHeightByViewportHeight(viewportHeight: number) {\n  if (viewportHeight >= BREAKPOINTS.MEDIUM_HEIGHT) {\n    return ViewHeight.MEDIUM;\n  }\n  if (viewportHeight >= BREAKPOINTS.MOBILE_LANDSCAPE_HEIGHT) {\n    return ViewHeight.SMALL;\n  }\n  return ViewHeight.EXTRA_SMALL;\n}\n\nexport function getViewHeightByMediaQueries(mediaQueries: MediaQueries): ViewHeight {\n  /* eslint-disable no-restricted-properties */\n  if (mediaQueries.mediumHeight.matches) {\n    return ViewHeight.MEDIUM;\n  }\n  if (mediaQueries.mobileLandscapeHeight.matches) {\n    return ViewHeight.SMALL;\n  }\n  /* eslint-enable no-restricted-properties */\n  return ViewHeight.EXTRA_SMALL;\n}\n\nexport function getSizeX(viewWidth: ViewWidth): SizeType {\n  return viewWidth <= ViewWidth.MOBILE ? SizeType.COMPACT : SizeType.REGULAR;\n}\n\nexport function isCompactByViewWidth(viewWidth: ViewWidth | undefined, hasPointer?: boolean) {\n  return viewWidth !== undefined && viewWidth >= ViewWidth.SMALL_TABLET && hasPointer;\n}\n\nexport function isCompactByViewHeight(viewHeight: ViewHeight | undefined) {\n  return viewHeight !== undefined && viewHeight <= ViewHeight.EXTRA_SMALL;\n}\n\nexport function getSizeY(\n  viewWidth: ViewWidth,\n  viewHeight: ViewHeight,\n  hasPointer: boolean,\n): SizeType {\n  if (isCompactByViewWidth(viewWidth, hasPointer) || isCompactByViewHeight(viewHeight)) {\n    return SizeType.COMPACT;\n  }\n  return SizeType.REGULAR;\n}\n\n/**\n * Проверка на Desktop.\n *\n * Функция гарантировано вернёт `boolean` или `null` в зависимости от условий.\n *\n * Возвращаем `null` в случае, если у нас недостаточно данных, чтобы определить платформу.\n *\n * ⚠️ При передаче Platform.VKCOM всегда будет возвращать `true`.\n */\nexport function tryToCheckIsDesktop(viewWidth: ViewWidth, viewHeight: ViewHeight, hasPointer: undefined | boolean, platform?: PlatformType): boolean; // prettier-ignore\nexport function tryToCheckIsDesktop(viewWidth: ViewWidth, viewHeight: undefined, hasPointer: boolean, platform?: PlatformType): boolean; // prettier-ignore\nexport function tryToCheckIsDesktop(viewWidth: undefined | ViewWidth, viewHeight: undefined, hasPointer: undefined, platform?: PlatformType): null; // prettier-ignore\nexport function tryToCheckIsDesktop(viewWidth: undefined, viewHeight: undefined | ViewHeight, hasPointer: undefined, platform?: PlatformType): null; // prettier-ignore\nexport function tryToCheckIsDesktop(viewWidth: undefined, viewHeight: undefined, hasPointer: undefined | boolean, platform?: PlatformType): null; // prettier-ignore\nexport function tryToCheckIsDesktop(viewWidth: undefined | ViewWidth, viewHeight: undefined | ViewHeight, hasPointer: undefined | boolean, platform?: PlatformType): null | boolean; // prettier-ignore\nexport function tryToCheckIsDesktop(\n  viewWidth: undefined | ViewWidth,\n  viewHeight: undefined | ViewHeight,\n  hasPointer: undefined | boolean,\n  platform?: PlatformType,\n): null | boolean {\n  // см. https://github.com/VKCOM/VKUI/pull/2473\n  const IS_VKCOM_CRUTCH = platform === Platform.VKCOM;\n\n  if (\n    ((viewWidth === undefined || hasPointer === undefined) &&\n      (viewWidth === undefined || viewHeight === undefined)) ||\n    (hasPointer === undefined && viewHeight === undefined)\n  ) {\n    return IS_VKCOM_CRUTCH ? true : null;\n  }\n\n  const widthIsLikeDesktop = viewWidth >= ViewWidth.SMALL_TABLET;\n  const otherParametersIsLikeDesktop =\n    hasPointer || (viewHeight !== undefined ? viewHeight >= ViewHeight.MEDIUM : false);\n\n  return (widthIsLikeDesktop && otherParametersIsLikeDesktop) || IS_VKCOM_CRUTCH;\n}\n\n/**\n * Конвертирует `viewWidth` в CSS брейкпоинты (см. тесты для наглядности).\n *\n * > Note: используется восклицательный знак (!), чтобы принудить TS поверить, что св-во точно не может быть\n * > `undefined`. Это всё из-за применения `Partial<...>` для объекта.\n */\nexport function viewWidthToClassName<T extends Partial<CSSBreakpointsClassNames>>(\n  breakpointClassNames: Exact<CSSBreakpointsClassNames, T>,\n  viewWidth: ViewWidth | 'none' = 'none',\n): string | null {\n  if (viewWidth === 'none') {\n    return breakpointClassNames.hasOwnProperty('none') ? breakpointClassNames['none']! : null;\n  }\n\n  const breakpoints: string[] = [];\n  const breakpointName = VIEW_WIDTH_TO_CSS_BREAKPOINT_MAP[viewWidth];\n\n  if (breakpointClassNames.hasOwnProperty(breakpointName)) {\n    breakpoints.push(breakpointClassNames[breakpointName]!);\n  }\n\n  if (viewWidth >= ViewWidth.MOBILE) {\n    if (breakpointClassNames.hasOwnProperty('mobilePlus')) {\n      breakpoints.push(breakpointClassNames['mobilePlus']!);\n    }\n  }\n\n  if (viewWidth >= ViewWidth.SMALL_TABLET) {\n    if (breakpointClassNames.hasOwnProperty('smallTabletPlus')) {\n      breakpoints.push(breakpointClassNames['smallTabletPlus']!);\n    }\n  } else {\n    if (breakpointClassNames.hasOwnProperty('smallTabletMinus')) {\n      breakpoints.push(breakpointClassNames['smallTabletMinus']!);\n    }\n  }\n\n  if (viewWidth >= ViewWidth.TABLET) {\n    if (breakpointClassNames.hasOwnProperty('tabletPlus')) {\n      breakpoints.push(breakpointClassNames['tabletPlus']!);\n    }\n  } else {\n    if (breakpointClassNames.hasOwnProperty('tabletMinus')) {\n      breakpoints.push(breakpointClassNames['tabletMinus']!);\n    }\n  }\n\n  return breakpoints.length > 0 ? breakpoints.join(' ') : null;\n}\n"],"names":["getSizeX","getSizeY","getViewHeightByMediaQueries","getViewHeightByViewportHeight","getViewWidthByMediaQueries","getViewWidthByViewportWidth","isCompactByViewHeight","isCompactByViewWidth","tryToCheckIsDesktop","viewWidthToClassName","viewportWidth","BREAKPOINTS","DESKTOP","ViewWidth","TABLET","SMALL_TABLET","MOBILE","SMALL_MOBILE","mediaQueries","desktopPlus","matches","tablet","smallTablet","mobile","viewportHeight","MEDIUM_HEIGHT","ViewHeight","MEDIUM","MOBILE_LANDSCAPE_HEIGHT","SMALL","EXTRA_SMALL","mediumHeight","mobileLandscapeHeight","viewWidth","SizeType","COMPACT","REGULAR","hasPointer","undefined","viewHeight","platform","IS_VKCOM_CRUTCH","Platform","VKCOM","widthIsLikeDesktop","otherParametersIsLikeDesktop","breakpointClassNames","hasOwnProperty","breakpoints","breakpointName","VIEW_WIDTH_TO_CSS_BREAKPOINT_MAP","push","length","join"],"mappings":"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"}