{"version":3,"sources":["../../../src/lib/browser.ts"],"sourcesContent":["import { detectIOS, noop } from '@vkontakte/vkjs';\nimport type { Version } from '../types';\n\nexport enum System {\n  IOS = 'ios',\n  UNKNOWN = '',\n}\n\nexport interface BrowserInfo {\n  userAgent: string;\n  system: System;\n  systemVersion: Version | null;\n}\n\nconst memoized: { [index: string]: BrowserInfo } = {};\n\nexport function computeBrowserInfo(userAgent = ''): BrowserInfo {\n  if (memoized[userAgent]) {\n    return memoized[userAgent];\n  }\n\n  let systemVersion: Version | null = null;\n  let system = System.UNKNOWN;\n\n  const { isIOS, iosMajor, iosMinor } = detectIOS(userAgent);\n\n  if (isIOS) {\n    system = System.IOS;\n    systemVersion = {\n      major: iosMajor,\n      minor: iosMinor,\n    };\n  }\n\n  const browserInfo: BrowserInfo = {\n    userAgent,\n    system,\n    systemVersion,\n  };\n\n  memoized[userAgent] = browserInfo;\n\n  return browserInfo;\n}\n\n/**\n * Эмуляция функции `window.matchMedia` для SSR.\n *\n * ⚠️ Желательно избегать использование этой эмуляции в SSR.\n */\nexport function mediaQueryNull(query: string): MediaQueryList {\n  return {\n    matches: false,\n    media: query,\n    onchange: noop,\n    addListener: noop,\n    removeListener: noop,\n    addEventListener: noop,\n    removeEventListener: noop,\n    dispatchEvent() {\n      return false;\n    },\n  };\n}\n"],"names":["computeBrowserInfo","mediaQueryNull","System","memoized","userAgent","systemVersion","system","detectIOS","isIOS","iosMajor","iosMinor","major","minor","browserInfo","query","matches","media","onchange","noop","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent"],"mappings":";;;;;;;;;;;;;;IAgBgBA,kBAAkB;eAAlBA;;IAkCAC,cAAc;eAAdA;;;oBAlDgB;;UAGpBC;;;GAAAA,WAAAA;AAWZ,IAAMC,WAA6C,CAAC;AAE7C,SAASH;QAAmBI,YAAAA,iEAAY;IAC7C,IAAID,QAAQ,CAACC,UAAU,EAAE;QACvB,OAAOD,QAAQ,CAACC,UAAU;IAC5B;IAEA,IAAIC,gBAAgC;IACpC,IAAIC;IAEJ,IAAsCC,aAAAA,IAAAA,eAAS,EAACH,YAAxCI,QAA8BD,WAA9BC,OAAOC,WAAuBF,WAAvBE,UAAUC,WAAaH,WAAbG;IAEzB,IAAIF,OAAO;QACTF;QACAD,gBAAgB;YACdM,OAAOF;YACPG,OAAOF;QACT;IACF;IAEA,IAAMG,cAA2B;QAC/BT,WAAAA;QACAE,QAAAA;QACAD,eAAAA;IACF;IAEAF,QAAQ,CAACC,UAAU,GAAGS;IAEtB,OAAOA;AACT;AAOO,SAASZ,eAAea,KAAa;IAC1C,OAAO;QACLC,SAAS;QACTC,OAAOF;QACPG,UAAUC,UAAI;QACdC,aAAaD,UAAI;QACjBE,gBAAgBF,UAAI;QACpBG,kBAAkBH,UAAI;QACtBI,qBAAqBJ,UAAI;QACzBK,eAAAA,SAAAA;YACE,OAAO;QACT;IACF;AACF"}