{"version":3,"sources":["../../../src/lib/platform.ts"],"sourcesContent":["import { querystring } from '@vkontakte/vkjs';\nimport { LiteralUnion } from '../types';\nimport { BrowserInfo, computeBrowserInfo } from './browser';\nimport { canUseDOM } from './dom';\n\nexport enum Platform {\n  ANDROID = 'android',\n  IOS = 'ios',\n  VKCOM = 'vkcom',\n}\n\n/**\n * TODO [>=6]: удалить из VKUI\n *\n * Значение, которое передаётся в качестве query-параметра при открытии VK Mini Apps\n * @see {@link https://dev.vk.com/mini-apps/development/launch-params#vk_platform vk_platform}\n *\n * @deprecated v5.8.0\n */\nfunction getPlatformByQueryString(queryString: string): Platform | undefined {\n  const PLATFORM_ALIAS = { desktop_web: Platform.VKCOM };\n  const isPlatformAlias = (platformAlias: string): platformAlias is keyof typeof PLATFORM_ALIAS =>\n    platformAlias in PLATFORM_ALIAS;\n  try {\n    const parsedQuery = querystring.parse(queryString);\n    const platformAliasByQuery = parsedQuery['vk_platform'];\n    return typeof platformAliasByQuery === 'string' && isPlatformAlias(platformAliasByQuery)\n      ? PLATFORM_ALIAS[platformAliasByQuery]\n      : undefined;\n  } catch (e) {\n    console.warn(e);\n    return;\n  }\n}\n\nconst platformByQueryString = canUseDOM ? getPlatformByQueryString(location.search) : undefined;\n\nexport type PlatformType = LiteralUnion<'android' | 'ios' | 'vkcom', string>;\n\nexport function platform(browserInfo?: BrowserInfo): PlatformType {\n  if (platformByQueryString) {\n    return platformByQueryString;\n  }\n\n  if (!browserInfo) {\n    browserInfo = computeBrowserInfo();\n  }\n\n  return browserInfo.system === 'ios' ? Platform.IOS : Platform.ANDROID;\n}\n"],"names":["platform","Platform","getPlatformByQueryString","queryString","PLATFORM_ALIAS","desktop_web","isPlatformAlias","platformAlias","parsedQuery","querystring","parse","platformAliasByQuery","undefined","e","console","warn","platformByQueryString","canUseDOM","location","search","browserInfo","computeBrowserInfo","system"],"mappings":";;;;;;;;;;;;;;IAuCgBA,QAAQ;eAARA;;;oBAvCY;uBAEoB;mBACtB;;UAEdC;;;;GAAAA,aAAAA;AAMZ;;;;;;;CAOC,GACD,SAASC,yBAAyBC,WAAmB;IACnD,IAAMC,iBAAiB;QAAEC,WAAW;IAAiB;IACrD,IAAMC,kBAAkB,SAACC;eACvBA,iBAAiBH;;IACnB,IAAI;QACF,IAAMI,cAAcC,iBAAW,CAACC,KAAK,CAACP;QACtC,IAAMQ,uBAAuBH,WAAW,CAAC,cAAc;QACvD,OAAO,OAAOG,yBAAyB,YAAYL,gBAAgBK,wBAC/DP,cAAc,CAACO,qBAAqB,GACpCC;IACN,EAAE,OAAOC,GAAG;QACVC,QAAQC,IAAI,CAACF;QACb;IACF;AACF;AAEA,IAAMG,wBAAwBC,cAAS,GAAGf,yBAAyBgB,SAASC,MAAM,IAAIP;AAI/E,SAASZ,SAASoB,WAAyB;IAChD,IAAIJ,uBAAuB;QACzB,OAAOA;IACT;IAEA,IAAI,CAACI,aAAa;QAChBA,cAAcC,IAAAA,2BAAkB;IAClC;IAEA,OAAOD,YAAYE,MAAM,KAAK;AAChC"}