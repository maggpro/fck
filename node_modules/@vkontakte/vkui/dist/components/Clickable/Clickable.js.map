{"version":3,"sources":["../../../src/components/Clickable/Clickable.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport {\n  type FocusVisibleModeProps,\n  useFocusVisibleClassName,\n} from '../../hooks/useFocusVisibleClassName';\nimport { callMultiple } from '../../lib/callMultiple';\nimport { RootComponent, RootComponentProps } from '../RootComponent/RootComponent';\nimport styles from './Clickable.module.css';\n\nexport interface ClickableProps<T> extends RootComponentProps<T>, FocusVisibleModeProps {\n  baseClassName?: string;\n}\n\n/**\n * Некликабельный компонент. Отключаем возможность нажимать на компонент.\n */\nconst NonClickable = <T,>({\n  href,\n  onClick,\n  onClickCapture,\n  ...restProps\n}: RootComponentProps<T>) => <RootComponent {...restProps} />;\n\n/**\n * Кликабельный компонент. Добавляем кучу обвесов\n */\nconst RealClickable = <T,>({\n  baseClassName,\n  children,\n  focusVisibleMode = 'inside',\n  ...restProps\n}: ClickableProps<T>) => {\n  const { focusVisible, onBlur, onFocus } = useFocusVisible();\n  const focusVisibleClassNames = useFocusVisibleClassName({ focusVisible, mode: focusVisibleMode });\n\n  return (\n    <RootComponent\n      baseClassName={classNames(baseClassName, focusVisibleClassNames, styles['Clickable__host'])}\n      onBlur={callMultiple(onBlur, restProps.onBlur)}\n      onFocus={callMultiple(onFocus, restProps.onFocus)}\n      {...restProps}\n    >\n      {children}\n    </RootComponent>\n  );\n};\n\n/**\n * Проверяем, является ли компонент кликабельным\n */\nfunction checkClickable<T>(props: ClickableProps<T>): boolean {\n  return (\n    (props.href !== undefined ||\n      props.onClick !== undefined ||\n      props.onClickCapture !== undefined) &&\n    !props.disabled\n  );\n}\n\n/**\n * Определяет правильный компонент и его свойства\n *\n * - если передан Component, используем его\n * - при передаче `href` превратится в `a`,\n * - при передаче `onClick` превратится в `div` c `role=\"button\"` и `tabIndex=\"0\"`.\n * - иначе используется `div`.\n */\nfunction component<T>({\n  Component,\n  onClick,\n  onClickCapture,\n  href,\n  disabled,\n}: RootComponentProps<T>): RootComponentProps<T> {\n  if (Component !== undefined) {\n    return { Component };\n  } else if (href !== undefined) {\n    return { 'Component': 'a', 'role': 'link', 'aria-disabled': disabled };\n  } else if (onClick !== undefined || onClickCapture !== undefined) {\n    return {\n      'Component': 'div',\n      'role': 'button',\n      'tabIndex': disabled ? undefined : 0,\n      'aria-disabled': disabled,\n    };\n  }\n\n  return {};\n}\n\n/**\n * Базовый кликабельный корневой компонент.\n *\n * - при передаче `href` превратится в `a`,\n * - при передаче `onClick` превратится в `div` c `role=\"button\"` и `tabIndex=\"0\"`.\n * - иначе используется `div`.\n */\nexport const Clickable = <T,>({ focusVisibleMode = 'inside', ...restProps }: ClickableProps<T>) => {\n  const commonProps = component(restProps);\n  const isClickable = checkClickable(restProps);\n\n  if (isClickable) {\n    return <RealClickable focusVisibleMode={focusVisibleMode} {...commonProps} {...restProps} />;\n  }\n\n  return <NonClickable {...commonProps} {...restProps} />;\n};\n"],"names":["React","classNames","useFocusVisible","useFocusVisibleClassName","callMultiple","RootComponent","NonClickable","href","onClick","onClickCapture","restProps","RealClickable","baseClassName","children","focusVisibleMode","focusVisible","onBlur","onFocus","focusVisibleClassNames","mode","checkClickable","props","undefined","disabled","component","Component","Clickable","commonProps","isClickable"],"mappings":";;AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,eAAe,QAAQ,8BAA8B;AAC9D,SAEEC,wBAAwB,QACnB,uCAAuC;AAC9C,SAASC,YAAY,QAAQ,yBAAyB;AACtD,SAASC,aAAa,QAA4B,iCAAiC;AAOnF;;CAEC,GACD,IAAMC,eAAe;QACnBC,cAAAA,MACAC,iBAAAA,SACAC,wBAAAA,gBACGC;QAHHH;QACAC;QACAC;;WAE2B,oBAACJ,eAAkBK;AAAY;AAE5D;;CAEC,GACD,IAAMC,gBAAgB;QACpBC,uBAAAA,eACAC,kBAAAA,2CACAC,kBAAAA,wDAAmB,oCAChBJ;QAHHE;QACAC;QACAC;;IAGA,IAA0CZ,mBAAAA,mBAAlCa,eAAkCb,iBAAlCa,cAAcC,SAAoBd,iBAApBc,QAAQC,UAAYf,iBAAZe;IAC9B,IAAMC,yBAAyBf,yBAAyB;QAAEY,cAAAA;QAAcI,MAAML;IAAiB;IAE/F,qBACE,oBAACT;QACCO,eAAeX,WAAWW,eAAeM;QACzCF,QAAQZ,aAAaY,QAAQN,UAAUM,MAAM;QAC7CC,SAASb,aAAaa,SAASP,UAAUO,OAAO;OAC5CP,YAEHG;AAGP;AAEA;;CAEC,GACD,SAASO,eAAkBC,KAAwB;IACjD,OACE,AAACA,CAAAA,MAAMd,IAAI,KAAKe,aACdD,MAAMb,OAAO,KAAKc,aAClBD,MAAMZ,cAAc,KAAKa,SAAQ,KACnC,CAACD,MAAME,QAAQ;AAEnB;AAEA;;;;;;;CAOC,GACD,SAASC,UAAa,KAME;QALtBC,YADoB,MACpBA,WACAjB,UAFoB,MAEpBA,SACAC,iBAHoB,MAGpBA,gBACAF,OAJoB,MAIpBA,MACAgB,WALoB,MAKpBA;IAEA,IAAIE,cAAcH,WAAW;QAC3B,OAAO;YAAEG,WAAAA;QAAU;IACrB,OAAO,IAAIlB,SAASe,WAAW;QAC7B,OAAO;YAAE,aAAa;YAAK,QAAQ;YAAQ,iBAAiBC;QAAS;IACvE,OAAO,IAAIf,YAAYc,aAAab,mBAAmBa,WAAW;QAChE,OAAO;YACL,aAAa;YACb,QAAQ;YACR,YAAYC,WAAWD,YAAY;YACnC,iBAAiBC;QACnB;IACF;IAEA,OAAO,CAAC;AACV;AAEA;;;;;;CAMC,GACD,OAAO,IAAMG,YAAY;yCAAOZ,kBAAAA,wDAAmB,oCAAaJ;QAAhCI;;IAC9B,IAAMa,cAAcH,UAAUd;IAC9B,IAAMkB,cAAcR,eAAeV;IAEnC,IAAIkB,aAAa;QACf,qBAAO,oBAACjB;YAAcG,kBAAkBA;WAAsBa,aAAiBjB;IACjF;IAEA,qBAAO,oBAACJ,iCAAiBqB,aAAiBjB;AAC5C,EAAE"}