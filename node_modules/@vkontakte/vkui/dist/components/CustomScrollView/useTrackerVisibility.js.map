{"version":3,"sources":["../../../src/components/CustomScrollView/useTrackerVisibility.ts"],"sourcesContent":["import * as React from 'react';\nimport { useTimeout } from '../../hooks/useTimeout';\n\n/**\n * Хук, который позволяет управлять видимостью ползунка скроллбара.\n * @param autoHideScrollbar - скрывать ли ползунок скроллбара\n * @param autoHideScrollbarDelay - через какое кол-во миллисекунд ползунок скроллбара скрывается\n * @returns Объект, содержащий параметры, которые позволяют управлять видимостью ползунка\n */\nexport const useTrackerVisibility = (\n  autoHideScrollbar = false,\n  autoHideScrollbarDelay = 500,\n): TrackerVisibilityProps => {\n  const [trackerVisible, setTrackerVisible] = React.useState(!autoHideScrollbar);\n  const isMouseOver = React.useRef(false);\n  const isTrackerDragging = React.useRef(false);\n\n  const { set: setVisibilityTimeout, clear: clearVisibilityTimeout } = useTimeout(\n    () => setTrackerVisible(false),\n    autoHideScrollbarDelay,\n  );\n\n  const onTrackerDragStart = React.useCallback(() => {\n    clearVisibilityTimeout();\n    setTrackerVisible(true);\n    isTrackerDragging.current = true;\n  }, [clearVisibilityTimeout]);\n\n  const onTrackerDragStop = React.useCallback(() => {\n    isTrackerDragging.current = false;\n    if (!isMouseOver.current) {\n      setVisibilityTimeout();\n    }\n  }, [setVisibilityTimeout, isMouseOver]);\n\n  /**\n   * Позволяет \"запланировать\" скрытие ползунка через delay миллисекунд. Если тайм-аут не успевает сработать, то каждый\n   * последующий вызов функции откладывает скрытие ползунка на delay миллисекунд\n   */\n  const queueTrackerVisibility = React.useCallback(() => {\n    if (isTrackerDragging.current) {\n      return;\n    }\n    setTrackerVisible(true);\n    setVisibilityTimeout();\n  }, [setVisibilityTimeout]);\n\n  const onTrackerMouseEnter = React.useCallback(() => {\n    clearVisibilityTimeout();\n    isMouseOver.current = true;\n    setTrackerVisible(true);\n  }, [clearVisibilityTimeout]);\n\n  const onTrackerMouseLeave = React.useCallback(() => {\n    queueTrackerVisibility();\n    isMouseOver.current = false;\n  }, [queueTrackerVisibility]);\n\n  const onTargetScroll = React.useCallback(() => {\n    queueTrackerVisibility();\n  }, [queueTrackerVisibility]);\n\n  return {\n    trackerVisible,\n    onTrackerDragStart,\n    onTrackerDragStop,\n    onTrackerMouseEnter,\n    onTrackerMouseLeave,\n    onTargetScroll,\n  };\n};\n\nexport interface TrackerOptionsProps {\n  /**\n   * Скрывать ли ползунок скроллбара\n   */\n  autoHideScrollbar?: boolean;\n  /**\n   * Через какое кол-во миллисекунд ползунок скроллбара скрывается\n   */\n  autoHideScrollbarDelay?: number;\n}\n\nexport interface TrackerVisibilityProps {\n  /**\n   * Отвечает за видимость ползунка\n   */\n  trackerVisible: boolean;\n  /**\n   * Функция для обработки события у блока со скроллом\n   */\n  onTargetScroll(this: void): void;\n  /**\n   * Функция для обработки начала drag event ползунка\n   */\n  onTrackerDragStart(this: void): void;\n  /**\n   * Функция для обработки окончания drag event ползунка\n   */\n  onTrackerDragStop(this: void): void;\n  /**\n   * Функция для обработки mouseLeave event ползунка\n   */\n  onTrackerMouseEnter(this: void): void;\n  /**\n   * Функция для обработки mouseEnter event ползунка\n   */\n  onTrackerMouseLeave(this: void): void;\n}\n"],"names":["React","useTimeout","useTrackerVisibility","autoHideScrollbar","autoHideScrollbarDelay","useState","trackerVisible","setTrackerVisible","isMouseOver","useRef","isTrackerDragging","set","setVisibilityTimeout","clear","clearVisibilityTimeout","onTrackerDragStart","useCallback","current","onTrackerDragStop","queueTrackerVisibility","onTrackerMouseEnter","onTrackerMouseLeave","onTargetScroll"],"mappings":";AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,QAAQ,yBAAyB;AAEpD;;;;;CAKC,GACD,OAAO,IAAMC,uBAAuB;QAClCC,qFAAoB,OACpBC,0FAAyB;IAEzB,IAA4CJ,mCAAAA,MAAMK,QAAQ,CAAC,CAACF,wBAArDG,iBAAqCN,oBAArBO,oBAAqBP;IAC5C,IAAMQ,cAAcR,MAAMS,MAAM,CAAC;IACjC,IAAMC,oBAAoBV,MAAMS,MAAM,CAAC;IAEvC,IAAqER,cAAAA,WACnE;eAAMM,kBAAkB;OACxBH,yBAFMO,AAAKC,uBAAwDX,YAA7DU,KAA2BE,AAAOC,yBAA2Bb,YAAlCY;IAKnC,IAAME,qBAAqBf,MAAMgB,WAAW,CAAC;QAC3CF;QACAP,kBAAkB;QAClBG,kBAAkBO,OAAO,GAAG;IAC9B,GAAG;QAACH;KAAuB;IAE3B,IAAMI,oBAAoBlB,MAAMgB,WAAW,CAAC;QAC1CN,kBAAkBO,OAAO,GAAG;QAC5B,IAAI,CAACT,YAAYS,OAAO,EAAE;YACxBL;QACF;IACF,GAAG;QAACA;QAAsBJ;KAAY;IAEtC;;;GAGC,GACD,IAAMW,yBAAyBnB,MAAMgB,WAAW,CAAC;QAC/C,IAAIN,kBAAkBO,OAAO,EAAE;YAC7B;QACF;QACAV,kBAAkB;QAClBK;IACF,GAAG;QAACA;KAAqB;IAEzB,IAAMQ,sBAAsBpB,MAAMgB,WAAW,CAAC;QAC5CF;QACAN,YAAYS,OAAO,GAAG;QACtBV,kBAAkB;IACpB,GAAG;QAACO;KAAuB;IAE3B,IAAMO,sBAAsBrB,MAAMgB,WAAW,CAAC;QAC5CG;QACAX,YAAYS,OAAO,GAAG;IACxB,GAAG;QAACE;KAAuB;IAE3B,IAAMG,iBAAiBtB,MAAMgB,WAAW,CAAC;QACvCG;IACF,GAAG;QAACA;KAAuB;IAE3B,OAAO;QACLb,gBAAAA;QACAS,oBAAAA;QACAG,mBAAAA;QACAE,qBAAAA;QACAC,qBAAAA;QACAC,gBAAAA;IACF;AACF,EAAE"}